{"id":"azure-keystore-certificates-02000","content":"<rule id=\"azure-keystore-certificates-02000\" xmlns=\"http://windup.jboss.org/schema/jboss-ruleset\">\n            <when>\n                <or>\n                    <javaclass references=\"java.security.KeyStore.getInstance({*})\">\n                        <location>METHOD_CALL</location>\n                    </javaclass>\n                    <javaclass references=\"java.security.KeyStore.load({*})\">\n                        <location>METHOD_CALL</location>\n                    </javaclass>\n                </or>\n            </when>\n            <perform>\n                <hint category-id=\"potential\" effort=\"3\" title=\"The application loads certificates into a KeyStore\">\n                    <message>\n                        The application loads a KeyStore from a file or an input stream. To migrate this code to Azure, you would need to modify it so it retrieves the cryptographic material from Azure Key Vault instead.\n\n                        * **Create an Azure Key Vault**: Azure Key Vault is a secure storage service that allows you to store and manage cryptographic keys, secrets, and certificates.\n\n                        * **Import keys and certificates into Azure Key Vault**: Use the Azure Key Vault Java SDK or Azure CLI to import the keys and certificates into Azure Key Vault. Create corresponding key and certificate objects in Azure Key Vault and import the key material and certificates obtained from the existing KeyStore.\n\n                        * **Update your Java code**: Modify your Java code that to retrieve the cryptographic material from Azure Key Vault. Instead of loading from a file or input stream, use the Azure Key Vault Java SDK to access the keys and certificates stored in Azure Key Vault. Update the code to authenticate and retrieve the cryptographic material using Azure.\n                    </message>\n                    <link href=\"https://learn.microsoft.com/azure/key-vault\" title=\"Azure Key Vault documentation\"/>\n                    <link href=\"https://github.com/Azure/azure-sdk-for-java/blob/main/sdk/keyvault/azure-security-keyvault-jca/README.md\" title=\"Azure Key Vault JCA client library for Java\"/>\n                    <link href=\"https://learn.microsoft.com/java/api/overview/azure/security-keyvault-certificates-readme\" title=\"Azure Key Vault Certificate client library for Java\"/>\n                </hint>\n            </perform>\n        </rule>"}